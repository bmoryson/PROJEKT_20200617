  METHOD CREATE_NEW_CUSTOMER.

    DATA: IVALS TYPE TABLE OF SVAL,
          XVALS TYPE SVAL,
          LV_ID TYPE CHAR12.

    ME->GS_WSB_CUSTOMER-PESEL = IV_PESEL.
    XVALS-TABNAME   = 'ZWSB_CUSTOMER'.


    XVALS-FIELDNAME = 'NAME1'.
    APPEND XVALS TO IVALS.

    CALL FUNCTION 'POPUP_GET_VALUES'
      EXPORTING
        POPUP_TITLE     = 'Proszę o podanie imienia'
      TABLES
        FIELDS          = IVALS
      EXCEPTIONS
        ERROR_IN_FIELDS = 1
        OTHERS          = 2.

    READ TABLE IVALS INTO XVALS WITH KEY FIELDNAME = 'NAME1'.
    IF SY-SUBRC  = 0.
      ME->GS_WSB_CUSTOMER-NAME1 = XVALS-VALUE.
    ENDIF.
    REFRESH IVALS[]. CLEAR XVALS-VALUE.

    XVALS-FIELDNAME = 'NAME2'.
    APPEND XVALS TO IVALS.

    CALL FUNCTION 'POPUP_GET_VALUES'
      EXPORTING
        POPUP_TITLE     = 'Proszę o podanie nazwiska'
      TABLES
        FIELDS          = IVALS
      EXCEPTIONS
        ERROR_IN_FIELDS = 1
        OTHERS          = 2.

    READ TABLE IVALS INTO XVALS WITH KEY FIELDNAME = 'NAME2'.
    IF SY-SUBRC  = 0.
      ME->GS_WSB_CUSTOMER-NAME2 = XVALS-VALUE.
    ENDIF.
    REFRESH IVALS[]. CLEAR XVALS-VALUE.


    XVALS-FIELDNAME = 'CITY'.
    APPEND XVALS TO IVALS.

    CALL FUNCTION 'POPUP_GET_VALUES'
      EXPORTING
        POPUP_TITLE     = 'Proszę o podanie miasta'
      TABLES
        FIELDS          = IVALS
      EXCEPTIONS
        ERROR_IN_FIELDS = 1
        OTHERS          = 2.

    READ TABLE IVALS INTO XVALS WITH KEY FIELDNAME = 'CITY'.
    IF SY-SUBRC  = 0.
      ME->GS_WSB_CUSTOMER-CITY = XVALS-VALUE.
    ENDIF.
    REFRESH IVALS[]. CLEAR XVALS-VALUE.


    XVALS-FIELDNAME = 'STREET'.
    APPEND XVALS TO IVALS.

    CALL FUNCTION 'POPUP_GET_VALUES'
      EXPORTING
        POPUP_TITLE     = 'Proszę o podanie ulicy'
      TABLES
        FIELDS          = IVALS
      EXCEPTIONS
        ERROR_IN_FIELDS = 1
        OTHERS          = 2.

    READ TABLE IVALS INTO XVALS WITH KEY FIELDNAME = 'STREET'.
    IF SY-SUBRC  = 0.
      ME->GS_WSB_CUSTOMER-STREET = XVALS-VALUE.
    ENDIF.
    REFRESH IVALS[]. CLEAR XVALS-VALUE.


    XVALS-FIELDNAME = 'ZIP'.
    APPEND XVALS TO IVALS.

    CALL FUNCTION 'POPUP_GET_VALUES'
      EXPORTING
        POPUP_TITLE     = 'Proszę o podanie kodu pocztowego'
      TABLES
        FIELDS          = IVALS
      EXCEPTIONS
        ERROR_IN_FIELDS = 1
        OTHERS          = 2.

    READ TABLE IVALS INTO XVALS WITH KEY FIELDNAME = 'ZIP'.
    IF SY-SUBRC  = 0.
      ME->GS_WSB_CUSTOMER-ZIP = XVALS-VALUE.
    ENDIF.
    REFRESH IVALS[]. CLEAR XVALS-VALUE.

    GET TIME STAMP FIELD ME->GS_WSB_CUSTOMER-CREATED_AT.
    GET TIME STAMP FIELD ME->GS_WSB_CUSTOMER-CHANGED_AT.
    ME->GS_WSB_CUSTOMER-CREATED_BY = SY-UNAME.
    ME->GS_WSB_CUSTOMER-CHANGED_BY = SY-UNAME.

    SELECT SINGLE MAX( USERID ) FROM ZWSB_CUSTOMER INTO LV_ID.
    ADD 1 TO LV_ID.
    WRITE LV_ID TO ME->GS_WSB_CUSTOMER-USERID.

    CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'
      EXPORTING
        INPUT  = ME->GS_WSB_CUSTOMER-USERID
      IMPORTING
        OUTPUT = ME->GS_WSB_CUSTOMER-USERID.

    IF ME->GS_WSB_CUSTOMER-ZIP IS INITIAL OR ME->GS_WSB_CUSTOMER-STREET IS INITIAL OR ME->GS_WSB_CUSTOMER-CITY IS INITIAL
      OR ME->GS_WSB_CUSTOMER-NAME2 IS INITIAL OR ME->GS_WSB_CUSTOMER-NAME1 IS INITIAL.
      RAISE NO_INPUT_DATA.

    ELSE.
      INSERT ZWSB_CUSTOMER FROM ME->GS_WSB_CUSTOMER.
      COMMIT WORK AND WAIT.
      ES_CUSTOMER = ME->GS_WSB_CUSTOMER.
    ENDIF.

    BREAK-POINT.

  ENDMETHOD.
